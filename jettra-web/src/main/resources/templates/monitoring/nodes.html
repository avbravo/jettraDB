{#for node in nodes}
<div class="card" data-cpu="{node.cpuUsage}" data-mem-used="{node.memoryUsage}" data-mem-max="{node.memoryMax}"
    data-disk-used="{node.diskUsage}" data-disk-max="{node.diskMax}">
    <div style="display: flex; justify-content: space-between; align-items: start;">
        <div>
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <h3 style="margin:0">Node: {node.id}</h3>
                {#if node.cpuUsage > 0}
                <span style="font-size: 0.7rem; color: #94a3b8;">({node.cpuUsage}% CPU)</span>
                {/if}
            </div>
            {#if node.raftRole == "LEADER"}
            <span
                style="font-size: 0.65rem; background: rgba(99, 102, 241, 0.2); color: var(--primary); padding: 0.1rem 0.4rem; border-radius: 4px; font-weight: 700; margin-top: 0.25rem; display: inline-block; border: 1px solid var(--primary);">LEADER</span>
            {/if}
        </div>
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            {#if node.status && (node.status.toUpperCase() == 'ONLINE' || node.status.toUpperCase() == 'ACTIVE' ||
            node.status.toUpperCase() == 'UP')}
            <span style="font-size: 0.75rem; font-weight: 600; color: #10b981;">{node.status.toUpperCase()}</span>
            <span class="status-dot" style="background: #10b981; box-shadow: 0 0 10px #10b981"></span>
            {#else}
            <span style="font-size: 0.75rem; font-weight: 600; color: #ef4444;">{node.status ? node.status.toUpperCase()
                : 'OFFLINE'}</span>
            <span class="status-dot" style="background: #ef4444; box-shadow: 0 0 10px #ef4444"></span>
            {/if}
        </div>
    </div>
    <p style="margin: 0.5rem 0">Role: {node.role}</p>
    <small style="color: #94a3b8; display: block; margin-bottom: 1rem;">Address: {node.address}</small>
    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
        <button class="btn"
            style="flex: 1; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3);"
            onclick="showNodeResources('{node.id}')">
            <div style="display: flex; align-items: center; justify-content: center; gap: 0.4rem;">
                <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002 2h2a2 2 0 002-2">
                    </path>
                </svg>
                <span>Resources</span>
            </div>
        </button>

        {#if isSuperUser}
        <button class="btn" id="stop-btn-{node.id}"
            style="flex: 1; background: rgba(239, 68, 68, 0.1); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);"
            onclick="stopNode('{node.id}')">ðŸ›‘ Stop</button>
        {/if}
    </div>
</div>
{#else}
<div style="color: grey; padding: 1rem;">No nodes registered.</div>
{/for}